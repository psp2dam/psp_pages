<!DOCTYPE html>
<html lang="es-ES">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="generator" content="VuePress 2.0.0-beta.67">
    <style>
      :root {
        --c-bg: #fff;
      }
      html.dark {
        --c-bg: #22272e;
      }
      html, body {
        background-color: var(--c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem('vuepress-color-scheme');
			const systemDarkMode = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
			if (userMode === 'dark' || (userMode !== 'light' && systemDarkMode)) {
				document.documentElement.classList.toggle('dark', true);
			}
    </script>
    <meta name="theme-color" content="#3eaf7c"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black"><link rel="icon" href="/psp_pages/psp_favicon.png"><title>4.2 Sockets TCP | Programación de Servicios y Procesos</title><meta name="description" content="Módulo PSP de 2º DAM">
    <link rel="preload" href="/psp_pages/assets/style-a14ab702.css" as="style"><link rel="stylesheet" href="/psp_pages/assets/style-a14ab702.css">
    <link rel="modulepreload" href="/psp_pages/assets/app-f513d7ce.js"><link rel="modulepreload" href="/psp_pages/assets/sockets-tcp.html-09501448.js"><link rel="modulepreload" href="/psp_pages/assets/sockets-tcp.html-c8dac399.js"><link rel="modulepreload" href="/psp_pages/assets/multithread_server_sequence-89666c43.js"><link rel="prefetch" href="/psp_pages/assets/index.html-f133f0c9.js" as="script"><link rel="prefetch" href="/psp_pages/assets/test_page.html-dd9bfa0c.js" as="script"><link rel="prefetch" href="/psp_pages/assets/index.html-ad205d14.js" as="script"><link rel="prefetch" href="/psp_pages/assets/index.html-1ed2bcbc.js" as="script"><link rel="prefetch" href="/psp_pages/assets/concurrency.html-cea8977e.js" as="script"><link rel="prefetch" href="/psp_pages/assets/index.html-19fea898.js" as="script"><link rel="prefetch" href="/psp_pages/assets/operatingsystem.html-6c654d81.js" as="script"><link rel="prefetch" href="/psp_pages/assets/process.html-68032138.js" as="script"><link rel="prefetch" href="/psp_pages/assets/console_annex.html-f30139a8.js" as="script"><link rel="prefetch" href="/psp_pages/assets/curl_annex.html-e84ae368.js" as="script"><link rel="prefetch" href="/psp_pages/assets/index.html-5f3d69e7.js" as="script"><link rel="prefetch" href="/psp_pages/assets/iostreams.html-140df912.js" as="script"><link rel="prefetch" href="/psp_pages/assets/ipc.html-0ef38476.js" as="script"><link rel="prefetch" href="/psp_pages/assets/processbuilder.html-40adaec1.js" as="script"><link rel="prefetch" href="/psp_pages/assets/runtime.html-2b8c591d.js" as="script"><link rel="prefetch" href="/psp_pages/assets/alternatives.html-f009a03f.js" as="script"><link rel="prefetch" href="/psp_pages/assets/arraylist_annex.html-3e0b1784.js" as="script"><link rel="prefetch" href="/psp_pages/assets/debugger_annex.html-018103fd.js" as="script"><link rel="prefetch" href="/psp_pages/assets/hashmap_annex.html-53e5f82a.js" as="script"><link rel="prefetch" href="/psp_pages/assets/index.html-0431a5b4.js" as="script"><link rel="prefetch" href="/psp_pages/assets/producer-consumer.html-2a4cbf44.js" as="script"><link rel="prefetch" href="/psp_pages/assets/runnable.html-3c85a447.js" as="script"><link rel="prefetch" href="/psp_pages/assets/synchronization.html-3c3f8e9a.js" as="script"><link rel="prefetch" href="/psp_pages/assets/index.html-67e08c72.js" as="script"><link rel="prefetch" href="/psp_pages/assets/sockets-tcp.html-5b25a688.js" as="script"><link rel="prefetch" href="/psp_pages/assets/sockets-udp.html-bd9f199f.js" as="script"><link rel="prefetch" href="/psp_pages/assets/stateful-protocols.html-3fd4c7da.js" as="script"><link rel="prefetch" href="/psp_pages/assets/tcp-ip.html-bc436d60.js" as="script"><link rel="prefetch" href="/psp_pages/assets/ftp.html-09d58d22.js" as="script"><link rel="prefetch" href="/psp_pages/assets/gmail_annex.html-26fccf52.js" as="script"><link rel="prefetch" href="/psp_pages/assets/index.html-37bf6cea.js" as="script"><link rel="prefetch" href="/psp_pages/assets/mail.html-698e276d.js" as="script"><link rel="prefetch" href="/psp_pages/assets/urls.html-3dc9aa78.js" as="script"><link rel="prefetch" href="/psp_pages/assets/asymmetric-keys.html-e727e87b.js" as="script"><link rel="prefetch" href="/psp_pages/assets/hash-functions.html-94dfd17b.js" as="script"><link rel="prefetch" href="/psp_pages/assets/index.html-57957c4e.js" as="script"><link rel="prefetch" href="/psp_pages/assets/jsse.html-0ed7504b.js" as="script"><link rel="prefetch" href="/psp_pages/assets/log4j_annex.html-a22ab4e6.js" as="script"><link rel="prefetch" href="/psp_pages/assets/security.html-ad09f3a7.js" as="script"><link rel="prefetch" href="/psp_pages/assets/symmetric-key.html-b6694a4a.js" as="script"><link rel="prefetch" href="/psp_pages/assets/concurrency.html-4ae60790.js" as="script"><link rel="prefetch" href="/psp_pages/assets/index.html-448dd084.js" as="script"><link rel="prefetch" href="/psp_pages/assets/operatingsystem.html-a3343488.js" as="script"><link rel="prefetch" href="/psp_pages/assets/process.html-ab2b48f9.js" as="script"><link rel="prefetch" href="/psp_pages/assets/console_annex.html-23e5de55.js" as="script"><link rel="prefetch" href="/psp_pages/assets/curl_annex.html-c4d00569.js" as="script"><link rel="prefetch" href="/psp_pages/assets/index.html-eacea1db.js" as="script"><link rel="prefetch" href="/psp_pages/assets/iostreams.html-7a9eae09.js" as="script"><link rel="prefetch" href="/psp_pages/assets/ipc.html-356ca3e1.js" as="script"><link rel="prefetch" href="/psp_pages/assets/processbuilder.html-974cf72f.js" as="script"><link rel="prefetch" href="/psp_pages/assets/runtime.html-b3314bfe.js" as="script"><link rel="prefetch" href="/psp_pages/assets/alternatives.html-eea36f39.js" as="script"><link rel="prefetch" href="/psp_pages/assets/arraylist_annex.html-5ecf0008.js" as="script"><link rel="prefetch" href="/psp_pages/assets/debugger_annex.html-adce6756.js" as="script"><link rel="prefetch" href="/psp_pages/assets/hashmap_annex.html-9f09e7a7.js" as="script"><link rel="prefetch" href="/psp_pages/assets/index.html-8ed0d755.js" as="script"><link rel="prefetch" href="/psp_pages/assets/producer-consumer.html-16c718ae.js" as="script"><link rel="prefetch" href="/psp_pages/assets/runnable.html-ad558aac.js" as="script"><link rel="prefetch" href="/psp_pages/assets/synchronization.html-01f361a1.js" as="script"><link rel="prefetch" href="/psp_pages/assets/index.html-facd1414.js" as="script"><link rel="prefetch" href="/psp_pages/assets/sockets-udp.html-b60d9320.js" as="script"><link rel="prefetch" href="/psp_pages/assets/stateful-protocols.html-4718b1d1.js" as="script"><link rel="prefetch" href="/psp_pages/assets/tcp-ip.html-a6d36f4c.js" as="script"><link rel="prefetch" href="/psp_pages/assets/ftp.html-645107b0.js" as="script"><link rel="prefetch" href="/psp_pages/assets/gmail_annex.html-3289abd5.js" as="script"><link rel="prefetch" href="/psp_pages/assets/index.html-439589b4.js" as="script"><link rel="prefetch" href="/psp_pages/assets/mail.html-b599082c.js" as="script"><link rel="prefetch" href="/psp_pages/assets/urls.html-fe972418.js" as="script"><link rel="prefetch" href="/psp_pages/assets/asymmetric-keys.html-e4a841cb.js" as="script"><link rel="prefetch" href="/psp_pages/assets/hash-functions.html-73ecb3c4.js" as="script"><link rel="prefetch" href="/psp_pages/assets/index.html-6ccfa24f.js" as="script"><link rel="prefetch" href="/psp_pages/assets/jsse.html-61571fe3.js" as="script"><link rel="prefetch" href="/psp_pages/assets/log4j_annex.html-a7339c1a.js" as="script"><link rel="prefetch" href="/psp_pages/assets/security.html-bc737f6b.js" as="script"><link rel="prefetch" href="/psp_pages/assets/symmetric-key.html-96f1b884.js" as="script"><link rel="prefetch" href="/psp_pages/assets/404.html-60b35caa.js" as="script"><link rel="prefetch" href="/psp_pages/assets/index.html-a7f2d0d6.js" as="script"><link rel="prefetch" href="/psp_pages/assets/test_page.html-b5188f9a.js" as="script"><link rel="prefetch" href="/psp_pages/assets/index.html-57727aac.js" as="script"><link rel="prefetch" href="/psp_pages/assets/index.html-681e5872.js" as="script"><link rel="prefetch" href="/psp_pages/assets/concurrency.html-72f85e43.js" as="script"><link rel="prefetch" href="/psp_pages/assets/index.html-b9d3ba67.js" as="script"><link rel="prefetch" href="/psp_pages/assets/operatingsystem.html-5996df94.js" as="script"><link rel="prefetch" href="/psp_pages/assets/process.html-f6633a9d.js" as="script"><link rel="prefetch" href="/psp_pages/assets/console_annex.html-654c101b.js" as="script"><link rel="prefetch" href="/psp_pages/assets/curl_annex.html-0fb8ef48.js" as="script"><link rel="prefetch" href="/psp_pages/assets/index.html-0c1b2174.js" as="script"><link rel="prefetch" href="/psp_pages/assets/iostreams.html-40343e1e.js" as="script"><link rel="prefetch" href="/psp_pages/assets/ipc.html-923db1b6.js" as="script"><link rel="prefetch" href="/psp_pages/assets/processbuilder.html-e98762dc.js" as="script"><link rel="prefetch" href="/psp_pages/assets/runtime.html-d6c6e1ab.js" as="script"><link rel="prefetch" href="/psp_pages/assets/alternatives.html-d3ad2b7b.js" as="script"><link rel="prefetch" href="/psp_pages/assets/arraylist_annex.html-88db9d47.js" as="script"><link rel="prefetch" href="/psp_pages/assets/debugger_annex.html-8644410a.js" as="script"><link rel="prefetch" href="/psp_pages/assets/hashmap_annex.html-e2fa31e9.js" as="script"><link rel="prefetch" href="/psp_pages/assets/index.html-8c1212d1.js" as="script"><link rel="prefetch" href="/psp_pages/assets/producer-consumer.html-ae684fa2.js" as="script"><link rel="prefetch" href="/psp_pages/assets/runnable.html-499662b9.js" as="script"><link rel="prefetch" href="/psp_pages/assets/synchronization.html-6c7e048a.js" as="script"><link rel="prefetch" href="/psp_pages/assets/index.html-07ee21e9.js" as="script"><link rel="prefetch" href="/psp_pages/assets/sockets-tcp.html-616da690.js" as="script"><link rel="prefetch" href="/psp_pages/assets/sockets-udp.html-125fa1a3.js" as="script"><link rel="prefetch" href="/psp_pages/assets/stateful-protocols.html-4dd222bd.js" as="script"><link rel="prefetch" href="/psp_pages/assets/tcp-ip.html-c9b9e5dc.js" as="script"><link rel="prefetch" href="/psp_pages/assets/ftp.html-867925f6.js" as="script"><link rel="prefetch" href="/psp_pages/assets/gmail_annex.html-0cb88db1.js" as="script"><link rel="prefetch" href="/psp_pages/assets/index.html-ac2671b2.js" as="script"><link rel="prefetch" href="/psp_pages/assets/mail.html-5da62f21.js" as="script"><link rel="prefetch" href="/psp_pages/assets/urls.html-2d67b491.js" as="script"><link rel="prefetch" href="/psp_pages/assets/asymmetric-keys.html-a4a3c720.js" as="script"><link rel="prefetch" href="/psp_pages/assets/hash-functions.html-4ea3094e.js" as="script"><link rel="prefetch" href="/psp_pages/assets/index.html-4448e1b6.js" as="script"><link rel="prefetch" href="/psp_pages/assets/jsse.html-55703244.js" as="script"><link rel="prefetch" href="/psp_pages/assets/log4j_annex.html-267859f5.js" as="script"><link rel="prefetch" href="/psp_pages/assets/security.html-cb766253.js" as="script"><link rel="prefetch" href="/psp_pages/assets/symmetric-key.html-e1153fc5.js" as="script"><link rel="prefetch" href="/psp_pages/assets/concurrency.html-dfcecdda.js" as="script"><link rel="prefetch" href="/psp_pages/assets/index.html-0c5ae1bd.js" as="script"><link rel="prefetch" href="/psp_pages/assets/operatingsystem.html-f7611290.js" as="script"><link rel="prefetch" href="/psp_pages/assets/process.html-77616cf4.js" as="script"><link rel="prefetch" href="/psp_pages/assets/console_annex.html-ebcb4c10.js" as="script"><link rel="prefetch" href="/psp_pages/assets/curl_annex.html-23096a08.js" as="script"><link rel="prefetch" href="/psp_pages/assets/index.html-7c00552c.js" as="script"><link rel="prefetch" href="/psp_pages/assets/iostreams.html-f6a0241d.js" as="script"><link rel="prefetch" href="/psp_pages/assets/ipc.html-ca2c059b.js" as="script"><link rel="prefetch" href="/psp_pages/assets/processbuilder.html-8f459073.js" as="script"><link rel="prefetch" href="/psp_pages/assets/runtime.html-d39696e5.js" as="script"><link rel="prefetch" href="/psp_pages/assets/alternatives.html-ce700925.js" as="script"><link rel="prefetch" href="/psp_pages/assets/arraylist_annex.html-8f8c2b84.js" as="script"><link rel="prefetch" href="/psp_pages/assets/debugger_annex.html-eb645595.js" as="script"><link rel="prefetch" href="/psp_pages/assets/hashmap_annex.html-923a1610.js" as="script"><link rel="prefetch" href="/psp_pages/assets/index.html-cb0b1dd5.js" as="script"><link rel="prefetch" href="/psp_pages/assets/producer-consumer.html-7a1fa36b.js" as="script"><link rel="prefetch" href="/psp_pages/assets/runnable.html-851465c9.js" as="script"><link rel="prefetch" href="/psp_pages/assets/synchronization.html-b24e5645.js" as="script"><link rel="prefetch" href="/psp_pages/assets/index.html-8a9c60b7.js" as="script"><link rel="prefetch" href="/psp_pages/assets/sockets-udp.html-62f8dc45.js" as="script"><link rel="prefetch" href="/psp_pages/assets/stateful-protocols.html-62e943fd.js" as="script"><link rel="prefetch" href="/psp_pages/assets/tcp-ip.html-0d9d339b.js" as="script"><link rel="prefetch" href="/psp_pages/assets/ftp.html-28f83b18.js" as="script"><link rel="prefetch" href="/psp_pages/assets/gmail_annex.html-46d7dbc7.js" as="script"><link rel="prefetch" href="/psp_pages/assets/index.html-9f128b60.js" as="script"><link rel="prefetch" href="/psp_pages/assets/mail.html-a4a5e753.js" as="script"><link rel="prefetch" href="/psp_pages/assets/urls.html-3e351ccb.js" as="script"><link rel="prefetch" href="/psp_pages/assets/asymmetric-keys.html-918475a3.js" as="script"><link rel="prefetch" href="/psp_pages/assets/hash-functions.html-1af4117e.js" as="script"><link rel="prefetch" href="/psp_pages/assets/index.html-7bdf5a65.js" as="script"><link rel="prefetch" href="/psp_pages/assets/jsse.html-10432f89.js" as="script"><link rel="prefetch" href="/psp_pages/assets/log4j_annex.html-79b5da0e.js" as="script"><link rel="prefetch" href="/psp_pages/assets/security.html-bde759c7.js" as="script"><link rel="prefetch" href="/psp_pages/assets/symmetric-key.html-853d8bcf.js" as="script"><link rel="prefetch" href="/psp_pages/assets/404.html-59108678.js" as="script"><link rel="prefetch" href="/psp_pages/assets/CCLicense-component-80ae505b.js" as="script"><link rel="prefetch" href="/psp_pages/assets/DocumentCover-component-c5a9b584.js" as="script"><link rel="prefetch" href="/psp_pages/assets/DownloadPDF-component-370f1aed.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container"><!--[--><header class="navbar"><div class="toggle-sidebar-button" title="Mostrar/Ocultar" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a href="/psp_pages/es/" class=""><img class="logo" src="/psp_pages/LogoIES.png" alt="Programación de Servicios y Procesos"><span class="site-name can-hide">Programación de Servicios y Procesos</span></a></span><div class="navbar-items-wrapper" style=""><!--[--><!--]--><nav class="navbar-items can-hide"><!--[--><div class="navbar-item"><a class="external-link" href="https://aules.edu.gva.es/semipresencial/" rel="noopener noreferrer" target="_blank" aria-label="Aules FP Semi"><!--[--><!--]--> Aules FP Semi <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">Abrir en una ventana nueva</span></span><!--[--><!--]--></a></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="Contenido del curso"><span class="title">Contenido del curso</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="Contenido del curso"><span class="title">Contenido del curso</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/psp_pages/es/unit1/" class="" aria-label="Tema 1 - Introducción a la programación concurrente"><!--[--><!--]--> Tema 1 - Introducción a la programación concurrente <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/psp_pages/es/unit2/" class="" aria-label="Tema 2 - Programación de procesos en Java"><!--[--><!--]--> Tema 2 - Programación de procesos en Java <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/psp_pages/es/unit3/" class="" aria-label="Tema 3 - Programación multihilo en Java"><!--[--><!--]--> Tema 3 - Programación multihilo en Java <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/psp_pages/es/unit4/" class="router-link-active" aria-label="Tema 4 - Programación en red en Java"><!--[--><!--]--> Tema 4 - Programación en red en Java <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/psp_pages/es/unit5/" class="" aria-label="Tema 5 - Servicios en red"><!--[--><!--]--> Tema 5 - Servicios en red <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/psp_pages/es/unit6/" class="" aria-label="Tema 6 - Técnicas de programación segura"><!--[--><!--]--> Tema 6 - Técnicas de programación segura <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="Idioma"><span class="title">Idioma</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="Idioma"><span class="title">Idioma</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/psp_pages/en/unit4/sockets-tcp.html" class="" aria-label="English"><!--[--><!--]--> English <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a aria-current="page" href="/psp_pages/es/unit4/sockets-tcp.html" class="router-link-active router-link-exact-active router-link-active" aria-label="Castellano"><!--[--><!--]--> Castellano <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><a class="external-link" href="https://github.com/psp2dam/psp_sources2022" rel="noopener noreferrer" target="_blank" aria-label="GitHub"><!--[--><!--]--> GitHub <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">Abrir en una ventana nueva</span></span><!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><button class="toggle-color-mode-button" title="toggle color mode"><svg style="" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg style="display:none;" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><form class="search-box" role="search"><input type="search" placeholder="Buscar" autocomplete="off" spellcheck="false" value><!----></form></div></header><!--]--><div class="sidebar-mask"></div><!--[--><aside class="sidebar"><nav class="navbar-items"><!--[--><div class="navbar-item"><a class="external-link" href="https://aules.edu.gva.es/semipresencial/" rel="noopener noreferrer" target="_blank" aria-label="Aules FP Semi"><!--[--><!--]--> Aules FP Semi <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">Abrir en una ventana nueva</span></span><!--[--><!--]--></a></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="Contenido del curso"><span class="title">Contenido del curso</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="Contenido del curso"><span class="title">Contenido del curso</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/psp_pages/es/unit1/" class="" aria-label="Tema 1 - Introducción a la programación concurrente"><!--[--><!--]--> Tema 1 - Introducción a la programación concurrente <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/psp_pages/es/unit2/" class="" aria-label="Tema 2 - Programación de procesos en Java"><!--[--><!--]--> Tema 2 - Programación de procesos en Java <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/psp_pages/es/unit3/" class="" aria-label="Tema 3 - Programación multihilo en Java"><!--[--><!--]--> Tema 3 - Programación multihilo en Java <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/psp_pages/es/unit4/" class="router-link-active" aria-label="Tema 4 - Programación en red en Java"><!--[--><!--]--> Tema 4 - Programación en red en Java <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/psp_pages/es/unit5/" class="" aria-label="Tema 5 - Servicios en red"><!--[--><!--]--> Tema 5 - Servicios en red <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/psp_pages/es/unit6/" class="" aria-label="Tema 6 - Técnicas de programación segura"><!--[--><!--]--> Tema 6 - Técnicas de programación segura <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="Idioma"><span class="title">Idioma</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="Idioma"><span class="title">Idioma</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/psp_pages/en/unit4/sockets-tcp.html" class="" aria-label="English"><!--[--><!--]--> English <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a aria-current="page" href="/psp_pages/es/unit4/sockets-tcp.html" class="router-link-active router-link-exact-active router-link-active" aria-label="Castellano"><!--[--><!--]--> Castellano <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><a class="external-link" href="https://github.com/psp2dam/psp_sources2022" rel="noopener noreferrer" target="_blank" aria-label="GitHub"><!--[--><!--]--> GitHub <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">Abrir en una ventana nueva</span></span><!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><ul class="sidebar-items"><!--[--><li><p tabindex="0" class="sidebar-item sidebar-heading active">Tema 4 - Programación en red en Java <!----></p><ul style="" class="sidebar-item-children"><!--[--><li><a href="/psp_pages/es/unit4/" class="router-link-active sidebar-item" aria-label="4 Introducción"><!--[--><!--]--> 4 Introducción <!--[--><!--]--></a><!----></li><li><a href="/psp_pages/es/unit4/tcp-ip.html" class="sidebar-item" aria-label="4.1 Pila de protocolos TCP IP"><!--[--><!--]--> 4.1 Pila de protocolos TCP IP <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/psp_pages/es/unit4/sockets-tcp.html" class="router-link-active router-link-exact-active router-link-active sidebar-item active" aria-label="4.2 Sockets TCP"><!--[--><!--]--> 4.2 Sockets TCP <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/psp_pages/es/unit4/sockets-tcp.html#_4-2-1-comunicacion-cliente-servidor-con-sockets-tcp" class="router-link-active router-link-exact-active sidebar-item" aria-label="4.2.1. Comunicación cliente/servidor con sockets TCP"><!--[--><!--]--> 4.2.1. Comunicación cliente/servidor con sockets TCP <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/psp_pages/es/unit4/sockets-tcp.html#programacion-de-aplicaciones-cliente-y-o-servidor" class="router-link-active router-link-exact-active sidebar-item" aria-label="Programación de aplicaciones Cliente y/o Servidor"><!--[--><!--]--> Programación de aplicaciones Cliente y/o Servidor <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a aria-current="page" href="/psp_pages/es/unit4/sockets-tcp.html#_4-2-2-cliente-tcp" class="router-link-active router-link-exact-active sidebar-item" aria-label="4.2.2. Cliente TCP"><!--[--><!--]--> 4.2.2. Cliente TCP <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/psp_pages/es/unit4/sockets-tcp.html#streams-para-e-s-en-los-sockets" class="router-link-active router-link-exact-active sidebar-item" aria-label="Streams para E/S en los sockets"><!--[--><!--]--> Streams para E/S en los sockets <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a aria-current="page" href="/psp_pages/es/unit4/sockets-tcp.html#_4-2-3-servidor-tcp" class="router-link-active router-link-exact-active sidebar-item" aria-label="4.2.3 Servidor TCP"><!--[--><!--]--> 4.2.3 Servidor TCP <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/psp_pages/es/unit4/sockets-tcp.html#_4-2-4-servidor-multihilo" class="router-link-active router-link-exact-active sidebar-item" aria-label="4.2.4 Servidor multihilo"><!--[--><!--]--> 4.2.4 Servidor multihilo <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a href="/psp_pages/es/unit4/sockets-udp.html" class="sidebar-item" aria-label="4.3 Sockets UDP"><!--[--><!--]--> 4.3 Sockets UDP <!--[--><!--]--></a><!----></li><li><a href="/psp_pages/es/unit4/stateful-protocols.html" class="sidebar-item" aria-label="4.4 Protocolos con estado"><!--[--><!--]--> 4.4 Protocolos con estado <!--[--><!--]--></a><!----></li><!--]--></ul></li><!--]--></ul><!--[--><!--]--></aside><!--]--><!--[--><main class="page"><!--[--><!--]--><div class="theme-default-content"><!--[--><!--]--><div><div true class="downloadLink" align="right"><a href="/psp_pages/pdf/4.2 Sockets TCP.pdf" download><img src="/psp_pages/images/download-pdf.png" title="descarga como PDF" alt="descarga PDF" height="50"></a><a href="/psp_pages/pdf/4.2 Sockets TCP.pdf" target="_blank"><img src="/psp_pages/images/open-pdf.png" title="abre como PDF" alt="abre PDF" height="50"></a></div><div true class="documentcover" align="center"><img src="/psp_pages/images/LogoPSP_mini_es.png" alt="PSP Logo"><h1>4.2 Sockets TCP</h1><h2></h2><img src="/psp_pages/LogoIES.png" alt="Logo IES Doctor Balmis" style="padding:2cm;"><div true class="cclicense" align="center"><p xmlns:cc="http://creativecommons.org/ns#" xmlns:dct="http://purl.org/dc/terms/"><a property="dct:title" rel="cc:attributionURL" href="https://psp2dam.github.io/psp_sources/es/">Apuntes de PSP</a> creados por <span property="cc:attributionName">Vicente Martínez</span> bajo licencia <a href="http://creativecommons.org/licenses/by-nc-sa/4.0/deed.es" target="_blank" rel="license noopener noreferrer" style="display:inline-block;"> CC BY-NC-SA 4.0<img style="height:22px!important;margin-left:3px;vertical-align:text-bottom;" src="https://mirrors.creativecommons.org/presskit/icons/cc.svg?ref=chooser-v1"><img style="height:22px!important;margin-left:3px;vertical-align:text-bottom;" src="https://mirrors.creativecommons.org/presskit/icons/by.svg?ref=chooser-v1"><img style="height:22px!important;margin-left:3px;vertical-align:text-bottom;" src="https://mirrors.creativecommons.org/presskit/icons/nc.svg?ref=chooser-v1"><img style="height:22px!important;margin-left:3px;vertical-align:text-bottom;" src="https://mirrors.creativecommons.org/presskit/icons/sa.svg?ref=chooser-v1"></a></p></div><div class="pagebreak"></div></div><h1 id="_4-2-sockets-tcp" tabindex="-1">4.2 Sockets TCP</h1><nav class="table-of-contents"><ul><li><a aria-current="page" href="/psp_pages/es/unit4/sockets-tcp.html#_4-2-1-comunicacion-cliente-servidor-con-sockets-tcp" class="router-link-active router-link-exact-active">4.2.1. Comunicación cliente/servidor con sockets TCP</a><ul><li><a aria-current="page" href="/psp_pages/es/unit4/sockets-tcp.html#programacion-de-aplicaciones-cliente-y-o-servidor" class="router-link-active router-link-exact-active">Programación de aplicaciones Cliente y/o Servidor</a></li></ul></li><li><a aria-current="page" href="/psp_pages/es/unit4/sockets-tcp.html#_4-2-2-cliente-tcp" class="router-link-active router-link-exact-active">4.2.2. Cliente TCP</a><ul><li><a aria-current="page" href="/psp_pages/es/unit4/sockets-tcp.html#streams-para-e-s-en-los-sockets" class="router-link-active router-link-exact-active">Streams para E/S en los sockets</a></li></ul></li><li><a aria-current="page" href="/psp_pages/es/unit4/sockets-tcp.html#_4-2-3-servidor-tcp" class="router-link-active router-link-exact-active">4.2.3 Servidor TCP</a></li><li><a aria-current="page" href="/psp_pages/es/unit4/sockets-tcp.html#_4-2-4-servidor-multihilo" class="router-link-active router-link-exact-active">4.2.4 Servidor multihilo</a></li></ul></nav><h2 id="_4-2-1-comunicacion-cliente-servidor-con-sockets-tcp" tabindex="-1">4.2.1. Comunicación cliente/servidor con sockets TCP</h2><p>Oracle ha resumido el uso de los sockets en un breve tutorial. Todo lo que podemos ver en ese tutorial lo vamos a ir comentando y ampliando en este apartado del tema</p><p><a href="https://docs.oracle.com/javase/tutorial/networking/sockets/index.html" target="_blank" rel="noopener noreferrer">Tutorial de Oracle: All about sockets<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">Abrir en una ventana nueva</span></span></a></p><p>La interfaz Java que da soporte a sockets TCP está constituida por las clases <strong>ServerSocket</strong> y <strong>Socket</strong>.</p><ul><li><p>ServerSocket: es utilizada por un servidor para crear un socket en el puerto en el que escucha las peticiones de conexión de los clientes. Su método <code>accept</code> toma una petición de conexión de la cola, o si la cola está vacía, se bloquea hasta que llega una petición.</p><p>El resultado de ejecutar accept es una instancia de Socket, a través del cual el servidor tiene acceso a los datos enviados por el cliente.</p></li><li><p>Socket: es utilizada tanto por el cliente como por el servidor. El cliente crea un socket especificando el nombre DNS del host y el puerto del servidor, así se crea el socket local y además se conecta con el servicio.</p><p>Esta clase proporciona los métodos <code>getInputStream</code> y <code>getOutputStream</code> para acceder a los dos streams asociados a un socket (recordemos que son bidireccionales), y devuelve tipos de datos InputStream y OutputStream, respectivamente, a partir de los cuales podemos construir <code>BufferedReader</code> y <code>PrintWriter</code>, respectivamente, para poder procesar los datos de forma más sencilla.</p></li></ul><h3 id="programacion-de-aplicaciones-cliente-y-o-servidor" tabindex="-1">Programación de aplicaciones Cliente y/o Servidor</h3><p>Al crear aplicaciones cliente y servidor puede que nos encontremos con varios escenarios, a saber:</p><ul><li>Si tenemos que programar solo el servidor <strong>deberemos definir un protocolo</strong> de comunicación para usar ese servidor.</li><li>Si tenemos que programar solo el cliente <strong>necesitaremos conocer el protocolo</strong> de comunicación para conectar con ese servidor.</li><li>Si tenemos que programar el cliente y el servidor, tendremos que empezar por <strong>definir el protocolo</strong> de comunicación entre ambos.</li></ul><div class="custom-container info"><p class="custom-container-title">Herramientas para definir los protocolos</p><p>Dentro de todos los diagramas que ofrece UML, el diagrama de secuencia es el que mejor se adapta para definir los protocolos de comunicación entre clases y las interacciones que se producen.</p><p>Para crear estos diagramas existen multitud de herramientas, tanto de escritorio como online. De todas ellas cabe destacar:</p><ul><li><a href="https://mermaid.live/" target="_blank" rel="noopener noreferrer">Mermaid Live editor<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">Abrir en una ventana nueva</span></span></a> que usa una <a href="https://mermaid-js.github.io/mermaid/#/sequenceDiagram" target="_blank" rel="noopener noreferrer">sintaxis en modo texto<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">Abrir en una ventana nueva</span></span></a> para definir los diagramas.</li><li><a href="https://www.websequencediagrams.com/" target="_blank" rel="noopener noreferrer">WebSequenceDiagrams<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">Abrir en una ventana nueva</span></span></a>: Más visual y también con una definición textual de los diagramas.</li><li><a href="https://online.visual-paradigm.com/drive/#diagramlist:proj=0&amp;dashboard" target="_blank" rel="noopener noreferrer">Visual Paradigm Online<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">Abrir en una ventana nueva</span></span></a>: Herramienta totalmente visual y con unos resultados más espectaculares.</li></ul><p>Estas herramientas son las que tenéis que usar en las actividades en las que se os pida definir un protocolo de comunicación cliente / servidor.</p></div><h2 id="_4-2-2-cliente-tcp" tabindex="-1">4.2.2. Cliente TCP</h2><p>Si nos centramos en la parte de comunicaciones, la forma general de implementar un cliente será:</p><ol><li>Crear un objeto de la clase Socket, indicando host y puerto donde corre el servicio.</li><li>Obtener las referencias al stream de entrada y al de salida al socket.</li><li>Leer desde y escribir en el stream de acuerdo al protocolo del servicio. Para ello emplear alguna de las facilidades del paquete java.io.</li><li>Cerrar los streams.</li><li>Cerrar el socket.</li></ol><div class="language-java line-numbers-mode" data-ext="java"><pre class="shiki material-theme-lighter" style="background-color:#FAFAFA;" tabindex="0"><code><span class="line"><span style="color:#9C3EDA;">public</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">class</span><span style="color:#90A4AE;"> </span><span style="color:#E2931D;">BasicClient</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">{</span></span>
<span class="line"></span>
<span class="line"><span style="color:#90A4AE;">    </span><span style="color:#9C3EDA;">public</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">static</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">void</span><span style="color:#90A4AE;"> </span><span style="color:#6182B8;">main</span><span style="color:#39ADB5;">(</span><span style="color:#9C3EDA;">String</span><span style="color:#39ADB5;">[]</span><span style="color:#90A4AE;"> </span><span style="color:#90A4AE;font-style:italic;">args</span><span style="color:#39ADB5;">)</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">throws</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">IOException</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">{</span></span>
<span class="line"><span style="color:#90A4AE;">        </span><span style="color:#9C3EDA;">Socket</span><span style="color:#90A4AE;"> socketCliente </span><span style="color:#39ADB5;">=</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">null;</span></span>
<span class="line"><span style="color:#90A4AE;">        </span><span style="color:#9C3EDA;">BufferedReader</span><span style="color:#90A4AE;"> entrada </span><span style="color:#39ADB5;">=</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">null;</span></span>
<span class="line"><span style="color:#90A4AE;">        </span><span style="color:#9C3EDA;">PrintWriter</span><span style="color:#90A4AE;"> salida </span><span style="color:#39ADB5;">=</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">null;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#39ADB5;">        </span><span style="color:#90A4AE;font-style:italic;">// Creamos un socket en el lado cliente, enlazado con un</span></span>
<span class="line"><span style="color:#39ADB5;">        </span><span style="color:#90A4AE;font-style:italic;">// servidor que está en la misma máquina que el cliente</span></span>
<span class="line"><span style="color:#39ADB5;">        </span><span style="color:#90A4AE;font-style:italic;">// y que escucha en el puerto 4444</span></span>
<span class="line"><span style="color:#90A4AE;">        </span><span style="color:#39ADB5;font-style:italic;">try</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">{</span></span>
<span class="line"><span style="color:#90A4AE;">            socketCliente </span><span style="color:#39ADB5;">=</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;font-style:italic;">new</span><span style="color:#90A4AE;"> </span><span style="color:#6182B8;">Socket</span><span style="color:#39ADB5;">(</span><span style="color:#39ADB5;">&quot;</span><span style="color:#91B859;">localhost</span><span style="color:#39ADB5;">&quot;</span><span style="color:#39ADB5;">,</span><span style="color:#90A4AE;"> </span><span style="color:#F76D47;">4444</span><span style="color:#39ADB5;">);</span></span>
<span class="line"><span style="color:#39ADB5;">            </span><span style="color:#90A4AE;font-style:italic;">// Obtenemos el canal de entrada</span></span>
<span class="line"><span style="color:#90A4AE;">            entrada </span><span style="color:#39ADB5;">=</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;font-style:italic;">new</span><span style="color:#90A4AE;"> </span><span style="color:#6182B8;">BufferedReader</span><span style="color:#39ADB5;">(</span></span>
<span class="line"><span style="color:#90A4AE;">                    </span><span style="color:#39ADB5;font-style:italic;">new</span><span style="color:#90A4AE;"> </span><span style="color:#6182B8;">InputStreamReader</span><span style="color:#39ADB5;">(</span><span style="color:#90A4AE;">socketCliente</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">getInputStream</span><span style="color:#39ADB5;">()));</span></span>
<span class="line"><span style="color:#39ADB5;">            </span><span style="color:#90A4AE;font-style:italic;">// Obtenemos el canal de salida</span></span>
<span class="line"><span style="color:#90A4AE;">            salida </span><span style="color:#39ADB5;">=</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;font-style:italic;">new</span><span style="color:#90A4AE;"> </span><span style="color:#6182B8;">PrintWriter</span><span style="color:#39ADB5;">(</span></span>
<span class="line"><span style="color:#90A4AE;">                    </span><span style="color:#39ADB5;font-style:italic;">new</span><span style="color:#90A4AE;"> </span><span style="color:#6182B8;">BufferedWriter</span><span style="color:#39ADB5;">(</span></span>
<span class="line"><span style="color:#90A4AE;">                            </span><span style="color:#39ADB5;font-style:italic;">new</span><span style="color:#90A4AE;"> </span><span style="color:#6182B8;">OutputStreamWriter</span><span style="color:#39ADB5;">(</span><span style="color:#90A4AE;">socketCliente</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">getOutputStream</span><span style="color:#39ADB5;">())),</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">true);</span></span>
<span class="line"><span style="color:#90A4AE;">        </span><span style="color:#39ADB5;">}</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;font-style:italic;">catch</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">(</span><span style="color:#9C3EDA;">IOException</span><span style="color:#90A4AE;"> </span><span style="color:#90A4AE;font-style:italic;">e</span><span style="color:#39ADB5;">)</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">{</span></span>
<span class="line"><span style="color:#90A4AE;">            System</span><span style="color:#39ADB5;">.</span><span style="color:#90A4AE;">err</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">println</span><span style="color:#39ADB5;">(</span><span style="color:#39ADB5;">&quot;</span><span style="color:#91B859;">No puede establecer canales de E/S para la conexión</span><span style="color:#39ADB5;">&quot;</span><span style="color:#39ADB5;">);</span></span>
<span class="line"><span style="color:#90A4AE;">            System</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">exit</span><span style="color:#39ADB5;">(-</span><span style="color:#F76D47;">1</span><span style="color:#39ADB5;">);</span></span>
<span class="line"><span style="color:#90A4AE;">        </span><span style="color:#39ADB5;">}</span></span>
<span class="line"><span style="color:#90A4AE;">        </span><span style="color:#9C3EDA;">Scanner</span><span style="color:#90A4AE;"> stdIn </span><span style="color:#39ADB5;">=</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;font-style:italic;">new</span><span style="color:#90A4AE;"> </span><span style="color:#6182B8;">Scanner</span><span style="color:#39ADB5;">(</span><span style="color:#90A4AE;">System</span><span style="color:#39ADB5;">.</span><span style="color:#90A4AE;">in</span><span style="color:#39ADB5;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#90A4AE;">        </span><span style="color:#9C3EDA;">String</span><span style="color:#90A4AE;"> linea</span><span style="color:#39ADB5;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#39ADB5;">        </span><span style="color:#90A4AE;font-style:italic;">// El programa cliente no analiza los mensajes enviados por el</span></span>
<span class="line"><span style="color:#39ADB5;">        </span><span style="color:#90A4AE;font-style:italic;">// usuario, simplemente los reenvía al servidor hasta que este</span></span>
<span class="line"><span style="color:#39ADB5;">        </span><span style="color:#90A4AE;font-style:italic;">// se despide con &quot;Adios&quot;</span></span>
<span class="line"><span style="color:#90A4AE;">        </span><span style="color:#39ADB5;font-style:italic;">try</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">{</span></span>
<span class="line"><span style="color:#90A4AE;">            </span><span style="color:#39ADB5;font-style:italic;">while</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">(true)</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">{</span></span>
<span class="line"><span style="color:#39ADB5;">                </span><span style="color:#90A4AE;font-style:italic;">// Leo la entrada del usuario</span></span>
<span class="line"><span style="color:#90A4AE;">                linea </span><span style="color:#39ADB5;">=</span><span style="color:#90A4AE;"> stdIn</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">nextLine</span><span style="color:#39ADB5;">();</span></span>
<span class="line"><span style="color:#39ADB5;">                </span><span style="color:#90A4AE;font-style:italic;">// La envia al servidor por el OutputStream</span></span>
<span class="line"><span style="color:#90A4AE;">                salida</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">println</span><span style="color:#39ADB5;">(</span><span style="color:#90A4AE;">linea</span><span style="color:#39ADB5;">);</span></span>
<span class="line"><span style="color:#39ADB5;">                </span><span style="color:#90A4AE;font-style:italic;">// Recibe la respuesta del servidor por el InputStream</span></span>
<span class="line"><span style="color:#90A4AE;">                linea </span><span style="color:#39ADB5;">=</span><span style="color:#90A4AE;"> entrada</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">readLine</span><span style="color:#39ADB5;">();</span></span>
<span class="line"><span style="color:#39ADB5;">                </span><span style="color:#90A4AE;font-style:italic;">// Envía a la salida estándar la respuesta del servidor</span></span>
<span class="line"><span style="color:#90A4AE;">                System</span><span style="color:#39ADB5;">.</span><span style="color:#90A4AE;">out</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">println</span><span style="color:#39ADB5;">(</span><span style="color:#39ADB5;">&quot;</span><span style="color:#91B859;">Respuesta servidor: </span><span style="color:#39ADB5;">&quot;</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">+</span><span style="color:#90A4AE;"> linea</span><span style="color:#39ADB5;">);</span></span>
<span class="line"><span style="color:#39ADB5;">                </span><span style="color:#90A4AE;font-style:italic;">// Si es &quot;Adios&quot; es que finaliza la comunicación</span></span>
<span class="line"><span style="color:#90A4AE;">                </span><span style="color:#39ADB5;font-style:italic;">if</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">(</span><span style="color:#90A4AE;">linea</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">equals</span><span style="color:#39ADB5;">(</span><span style="color:#39ADB5;">&quot;</span><span style="color:#91B859;">Adios</span><span style="color:#39ADB5;">&quot;</span><span style="color:#39ADB5;">))</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">{</span></span>
<span class="line"><span style="color:#90A4AE;">                    </span><span style="color:#39ADB5;font-style:italic;">break</span><span style="color:#39ADB5;">;</span></span>
<span class="line"><span style="color:#90A4AE;">                </span><span style="color:#39ADB5;">}</span></span>
<span class="line"><span style="color:#90A4AE;">            </span><span style="color:#39ADB5;">}</span></span>
<span class="line"><span style="color:#90A4AE;">        </span><span style="color:#39ADB5;">}</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;font-style:italic;">catch</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">(</span><span style="color:#9C3EDA;">IOException</span><span style="color:#90A4AE;"> </span><span style="color:#90A4AE;font-style:italic;">e</span><span style="color:#39ADB5;">)</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">{</span></span>
<span class="line"><span style="color:#90A4AE;">            System</span><span style="color:#39ADB5;">.</span><span style="color:#90A4AE;">out</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">println</span><span style="color:#39ADB5;">(</span><span style="color:#39ADB5;">&quot;</span><span style="color:#91B859;">IOException: </span><span style="color:#39ADB5;">&quot;</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">+</span><span style="color:#90A4AE;"> e</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">getMessage</span><span style="color:#39ADB5;">());</span></span>
<span class="line"><span style="color:#90A4AE;">        </span><span style="color:#39ADB5;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#39ADB5;">        </span><span style="color:#90A4AE;font-style:italic;">// Libera recursos</span></span>
<span class="line"><span style="color:#90A4AE;">        salida</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">close</span><span style="color:#39ADB5;">();</span></span>
<span class="line"><span style="color:#90A4AE;">        entrada</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">close</span><span style="color:#39ADB5;">();</span></span>
<span class="line"><span style="color:#90A4AE;">        stdIn</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">close</span><span style="color:#39ADB5;">();</span></span>
<span class="line"><span style="color:#90A4AE;">        socketCliente</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">close</span><span style="color:#39ADB5;">();</span></span>
<span class="line"><span style="color:#90A4AE;">    </span><span style="color:#39ADB5;">}</span></span>
<span class="line"><span style="color:#39ADB5;">}</span></span>
<span class="line"></span>
<span class="line"></span></code></pre><div class="highlight-lines"><br><br><br><br><br><br><br><br><br><br><br><div class="highlight-line"> </div><br><div class="highlight-line"> </div><br><br><div class="highlight-line"> </div><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><div class="highlight-line"> </div><br><div class="highlight-line"> </div><br><br><br><br><br><br><br><br><br><br><br><br><div class="highlight-line"> </div><div class="highlight-line"> </div><br><div class="highlight-line"> </div><br><br><br></div><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="custom-container info"><p class="custom-container-title">Herramientas para simular clientes genéricos</p><p>Si sólo tenemos que desarrollar un servidor y no tenemos o no queremos hacer un cliente para las pruebas, tenemos varias herramientas que nos ayudan a hacer de clientes genéricos, útiles para una gran variedad de servidores, incluso para servidores estándar como FTP, HTTP, etc.</p><p>La primera herramienta es una aplicación y un protocolo de nivel de aplicación de TCP/IP, es la herramienta <code>Telnet</code>.</p><p>Esta herramienta suele venir instalada en los sistemas GNU/Linux y OS X. Sin embargo en los sistemas Windows viene deshabilitada por defecto.</p><p>Os dejo un enlace al artículo de Xataka <a href="https://www.xataka.com/basics/telnet-que-como-activarlo-windows-10" target="_blank" rel="noopener noreferrer">Telnet: qué es y cómo activarlo en Windows 10<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">Abrir en una ventana nueva</span></span></a>.</p><p>Es importante que lo activéis tanto en clase como en el aula.</p><p>La segunda herramienta es NetCat. Es una herramienta muy versátil y potente, ya que no sólo puede hacernos de cliente, sino que también puede servir como servidor.</p><p>Como muchas otras herramientas, esta también viene instalada de serie en GNU/Linux y OS X, pero no en Windows. Su uso en los sistemas de Microsoft es algo más controvertido ya que el sistema la detecta como un virus y tenemos que habilitar su uso en el <em>Guardian</em> del SO.</p><p>Os dejo también un enlace a este artículo de IONOS <a href="https://www.ionos.es/digitalguide/servidores/herramientas/netcat/" target="_blank" rel="noopener noreferrer">¿Qué es Netcat y cómo funciona?<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">Abrir en una ventana nueva</span></span></a></p></div><h3 id="streams-para-e-s-en-los-sockets" tabindex="-1">Streams para E/S en los sockets</h3><p>Si vemos ejemplos en Internet o en tutoriales, podemos observar que hay dos formas mayoritarias de enviar y recibir la información a través de los streams que proporciona un socket.</p><p><img src="/psp_pages/assets/basicIOStreams-fe2078c1.png" alt="Basic Stream IO"></p><p>En cualquier caso, a través de los streams enviamos bytes, que es la forma más básica de generar información, bien sea a través de la red o entre procesos.</p><p>Como es complicado gestionar a nivel de bytes toda la información que queremos enviar o recibir, usamos <code>Decorators</code> o <code>Wrappers</code> para enviar tipos de datos de un nivel de abstracción mayor.</p><p>En los temas anteriores, cuando hemos tenido que intercambiar información entre procesos, hemos estado usando BufferedReader y PrintWriter. Estas clases trabajan a nivel de Strings, y son muy útiles cuando lo que queremos intercambiar a través de los streams son cadenas de texto.</p><blockquote><p>En los protocolos de comunicaciones, más del 90% de la información que se intercambia, a nivel de protocolo, es en formato texto.</p></blockquote><p>Sin embargo, puede haber ocasiones en las que nos interese trabajar con tipos de datos.</p><p><code>DataInputStream</code> y <code>DataOutputStream</code> proporcionan métodos para leer y escribir Strings y todos los tipos de datos primitivos de Java, incluyendo números y valores booleanos.</p><p><img src="/psp_pages/assets/streamWrappers-dffb8fec.png" alt="Basic Stream IO"></p><p>DataOutputStream codifica esos valores de forma independiente de la máquina y los envía al stream de más bajo nivel para que los gestione como bytes. DataInputStream hace lo contrario.</p><p>Así, podemos trabajar con DataInputStream y DataOutputStream a partir de los streams que nos proporcionan los sockets</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="shiki material-theme-lighter" style="background-color:#FAFAFA;" tabindex="0"><code><span class="line"><span style="color:#90A4AE;font-style:italic;">// Código en el cliente</span></span>
<span class="line"><span style="color:#9C3EDA;">DataInputStream</span><span style="color:#90A4AE;"> dis </span><span style="color:#39ADB5;">=</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;font-style:italic;">new</span><span style="color:#90A4AE;"> </span><span style="color:#6182B8;">DataInputStream</span><span style="color:#39ADB5;">(</span><span style="color:#90A4AE;">socket</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">getInputStream</span><span style="color:#39ADB5;">());</span></span>
<span class="line"><span style="color:#90A4AE;">dis</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">readDouble</span><span style="color:#39ADB5;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#90A4AE;font-style:italic;">// Código en el servidor</span></span>
<span class="line"><span style="color:#9C3EDA;">DataOutputStream</span><span style="color:#90A4AE;"> dos </span><span style="color:#39ADB5;">=</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;font-style:italic;">new</span><span style="color:#90A4AE;"> </span><span style="color:#6182B8;">DataOutputStream</span><span style="color:#39ADB5;">(</span><span style="color:#90A4AE;">socket</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">getOutputStream</span><span style="color:#39ADB5;">());</span></span>
<span class="line"><span style="color:#90A4AE;">dis</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">writeDouble</span><span style="color:#39ADB5;">(</span><span style="color:#90A4AE;">number</span><span style="color:#39ADB5;">);</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Los métodos <code>readUTF()</code> and <code>writeUTF()</code> de DataInputStream y DataOutputStream leen y escriben un String de caracteres Unicode usando la codificación UTF-8.</p><div class="custom-container warning"><p class="custom-container-title">Elige un método y usa siempre el mismo</p><p>Es muy importante no mezclar diferentes wrappers en el mismo sistema. Aunque todos acaban utilizando el InputStream y el OutputStream, las codificaciones y la forma de enviar la información no es la misma.</p><p>Por lo que, si usas DataInputStream en el cliente para leer, debes usar DataOutputStream en el servidor para enviar. Además de usar los métodos complementarios para la lectura y escritura, por ejemplo readInt / writeInt.</p></div><p>Información extraída de <a href="https://www.oreilly.com/library/view/learning-java-4th/9781449372477/ch12s01.html" target="_blank" rel="noopener noreferrer">Learning Java, 4th Edition - O&#39;Reilly<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">Abrir en una ventana nueva</span></span></a></p><div class="pagebreak"></div><h2 id="_4-2-3-servidor-tcp" tabindex="-1">4.2.3 Servidor TCP</h2><p>La forma de implementar un servidor será:</p><p><img src="/psp_pages/assets/monothread_server_states-90797430.png" alt="Estados de un servidor monohilo"></p><ol><li>Crear un objeto de la clase ServerSocket para escuchar peticiones en el puerto asignado al servicio.</li><li>Esperar solicitudes de clientes</li><li>Cuando se produce una solicitud: <ul><li>Aceptar la conexión obteniendo un objeto de la clase Socket</li><li>Obtener las referencias al stream de entrada y al de salida al socket anterior.</li><li>Leer datos del socket, procesarlos y enviar respuestas al cliente, escribiendo en el stream del socket.Para ello emplear alguna de las facilidades del paquete java.io.</li></ul></li><li>Cerrar los streams.</li><li>Cerrar los sockets.</li></ol><div class="language-java line-numbers-mode" data-ext="java"><pre class="shiki material-theme-lighter" style="background-color:#FAFAFA;" tabindex="0"><code><span class="line"><span style="color:#9C3EDA;">public</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">class</span><span style="color:#90A4AE;"> </span><span style="color:#E2931D;">BasicServer</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">{</span></span>
<span class="line"></span>
<span class="line"><span style="color:#90A4AE;">    </span><span style="color:#9C3EDA;">public</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">static</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">final</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">int</span><span style="color:#90A4AE;"> PORT </span><span style="color:#39ADB5;">=</span><span style="color:#90A4AE;"> </span><span style="color:#F76D47;">4444</span><span style="color:#39ADB5;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#90A4AE;">    </span><span style="color:#9C3EDA;">public</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">static</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">void</span><span style="color:#90A4AE;"> </span><span style="color:#6182B8;">main</span><span style="color:#39ADB5;">(</span><span style="color:#9C3EDA;">String</span><span style="color:#39ADB5;">[]</span><span style="color:#90A4AE;"> </span><span style="color:#90A4AE;font-style:italic;">args</span><span style="color:#39ADB5;">)</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">throws</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">IOException</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">{</span></span>
<span class="line"><span style="color:#39ADB5;">        </span><span style="color:#90A4AE;font-style:italic;">// Establece el puerto en el que escucha peticiones</span></span>
<span class="line"><span style="color:#90A4AE;">        </span><span style="color:#9C3EDA;">ServerSocket</span><span style="color:#90A4AE;"> socketServidor </span><span style="color:#39ADB5;">=</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">null;</span></span>
<span class="line"><span style="color:#90A4AE;">        </span><span style="color:#39ADB5;font-style:italic;">try</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">{</span></span>
<span class="line"><span style="color:#90A4AE;">            socketServidor </span><span style="color:#39ADB5;">=</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;font-style:italic;">new</span><span style="color:#90A4AE;"> </span><span style="color:#6182B8;">ServerSocket</span><span style="color:#39ADB5;">(</span><span style="color:#90A4AE;">PORT</span><span style="color:#39ADB5;">);</span></span>
<span class="line"><span style="color:#90A4AE;">        </span><span style="color:#39ADB5;">}</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;font-style:italic;">catch</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">(</span><span style="color:#9C3EDA;">IOException</span><span style="color:#90A4AE;"> </span><span style="color:#90A4AE;font-style:italic;">e</span><span style="color:#39ADB5;">)</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">{</span></span>
<span class="line"><span style="color:#90A4AE;">            System</span><span style="color:#39ADB5;">.</span><span style="color:#90A4AE;">out</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">println</span><span style="color:#39ADB5;">(</span><span style="color:#39ADB5;">&quot;</span><span style="color:#91B859;">No puede escuchar en el puerto: </span><span style="color:#39ADB5;">&quot;</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">+</span><span style="color:#90A4AE;"> PORT</span><span style="color:#39ADB5;">);</span></span>
<span class="line"><span style="color:#90A4AE;">            System</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">exit</span><span style="color:#39ADB5;">(-</span><span style="color:#F76D47;">1</span><span style="color:#39ADB5;">);</span></span>
<span class="line"><span style="color:#90A4AE;">        </span><span style="color:#39ADB5;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#90A4AE;">        </span><span style="color:#9C3EDA;">Socket</span><span style="color:#90A4AE;"> socketCliente </span><span style="color:#39ADB5;">=</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">null;</span></span>
<span class="line"><span style="color:#90A4AE;">        </span><span style="color:#9C3EDA;">BufferedReader</span><span style="color:#90A4AE;"> entrada </span><span style="color:#39ADB5;">=</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">null;</span></span>
<span class="line"><span style="color:#90A4AE;">        </span><span style="color:#9C3EDA;">PrintWriter</span><span style="color:#90A4AE;"> salida </span><span style="color:#39ADB5;">=</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">null;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#90A4AE;">        System</span><span style="color:#39ADB5;">.</span><span style="color:#90A4AE;">out</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">println</span><span style="color:#39ADB5;">(</span><span style="color:#39ADB5;">&quot;</span><span style="color:#91B859;">Escuchando: </span><span style="color:#39ADB5;">&quot;</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">+</span><span style="color:#90A4AE;"> socketServidor</span><span style="color:#39ADB5;">);</span></span>
<span class="line"><span style="color:#90A4AE;">        </span><span style="color:#39ADB5;font-style:italic;">try</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">{</span></span>
<span class="line"><span style="color:#39ADB5;">            </span><span style="color:#90A4AE;font-style:italic;">// Se bloquea hasta que recibe alguna petición de un cliente</span></span>
<span class="line"><span style="color:#39ADB5;">            </span><span style="color:#90A4AE;font-style:italic;">// abriendo un socket para el cliente</span></span>
<span class="line"><span style="color:#90A4AE;">            socketCliente </span><span style="color:#39ADB5;">=</span><span style="color:#90A4AE;"> socketServidor</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">accept</span><span style="color:#39ADB5;">();</span></span>
<span class="line"><span style="color:#90A4AE;">            System</span><span style="color:#39ADB5;">.</span><span style="color:#90A4AE;">out</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">println</span><span style="color:#39ADB5;">(</span><span style="color:#39ADB5;">&quot;</span><span style="color:#91B859;">Conexión aceptada: </span><span style="color:#39ADB5;">&quot;</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">+</span><span style="color:#90A4AE;"> socketCliente</span><span style="color:#39ADB5;">);</span></span>
<span class="line"><span style="color:#39ADB5;">            </span><span style="color:#90A4AE;font-style:italic;">// Establece canal de entrada</span></span>
<span class="line"><span style="color:#90A4AE;">            entrada </span><span style="color:#39ADB5;">=</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;font-style:italic;">new</span><span style="color:#90A4AE;"> </span><span style="color:#6182B8;">BufferedReader</span><span style="color:#39ADB5;">(</span></span>
<span class="line"><span style="color:#90A4AE;">                    </span><span style="color:#39ADB5;font-style:italic;">new</span><span style="color:#90A4AE;"> </span><span style="color:#6182B8;">InputStreamReader</span><span style="color:#39ADB5;">(</span><span style="color:#90A4AE;">socketCliente</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">getInputStream</span><span style="color:#39ADB5;">()));</span></span>
<span class="line"><span style="color:#39ADB5;">            </span><span style="color:#90A4AE;font-style:italic;">// Establece canal de salida</span></span>
<span class="line"><span style="color:#90A4AE;">            salida </span><span style="color:#39ADB5;">=</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;font-style:italic;">new</span><span style="color:#90A4AE;"> </span><span style="color:#6182B8;">PrintWriter</span><span style="color:#39ADB5;">(</span></span>
<span class="line"><span style="color:#90A4AE;">                    </span><span style="color:#39ADB5;font-style:italic;">new</span><span style="color:#90A4AE;"> </span><span style="color:#6182B8;">BufferedWriter</span><span style="color:#39ADB5;">(</span></span>
<span class="line"><span style="color:#90A4AE;">                            </span><span style="color:#39ADB5;font-style:italic;">new</span><span style="color:#90A4AE;"> </span><span style="color:#6182B8;">OutputStreamWriter</span><span style="color:#39ADB5;">(</span><span style="color:#90A4AE;">socketCliente</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">getOutputStream</span><span style="color:#39ADB5;">())),</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">true);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#39ADB5;">            </span><span style="color:#90A4AE;font-style:italic;">// Hace eco de lo que le proporciona el cliente, hasta que recibe &quot;Adios&quot;</span></span>
<span class="line"><span style="color:#90A4AE;">            </span><span style="color:#39ADB5;font-style:italic;">while</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">(true)</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">{</span></span>
<span class="line"><span style="color:#39ADB5;">                </span><span style="color:#90A4AE;font-style:italic;">// Recibe la solicitud del cliente por el InputStream</span></span>
<span class="line"><span style="color:#90A4AE;">                </span><span style="color:#9C3EDA;">String</span><span style="color:#90A4AE;"> str </span><span style="color:#39ADB5;">=</span><span style="color:#90A4AE;"> entrada</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">readLine</span><span style="color:#39ADB5;">();</span></span>
<span class="line"><span style="color:#39ADB5;">                </span><span style="color:#90A4AE;font-style:italic;">// Envía a la salida estándar el mensaje del cliente</span></span>
<span class="line"><span style="color:#90A4AE;">                System</span><span style="color:#39ADB5;">.</span><span style="color:#90A4AE;">out</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">println</span><span style="color:#39ADB5;">(</span><span style="color:#39ADB5;">&quot;</span><span style="color:#91B859;">Cliente: </span><span style="color:#39ADB5;">&quot;</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">+</span><span style="color:#90A4AE;"> str</span><span style="color:#39ADB5;">);</span></span>
<span class="line"><span style="color:#39ADB5;">                </span><span style="color:#90A4AE;font-style:italic;">// Le envía la respuesta al cliente por el OutputStream                </span></span>
<span class="line"><span style="color:#90A4AE;">                salida</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">println</span><span style="color:#39ADB5;">(</span><span style="color:#90A4AE;">str</span><span style="color:#39ADB5;">);</span></span>
<span class="line"><span style="color:#39ADB5;">                </span><span style="color:#90A4AE;font-style:italic;">// Si es &quot;Adios&quot; es que finaliza la comunicación</span></span>
<span class="line"><span style="color:#90A4AE;">                </span><span style="color:#39ADB5;font-style:italic;">if</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">(</span><span style="color:#90A4AE;">str</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">equals</span><span style="color:#39ADB5;">(</span><span style="color:#39ADB5;">&quot;</span><span style="color:#91B859;">Adios</span><span style="color:#39ADB5;">&quot;</span><span style="color:#39ADB5;">))</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">{</span></span>
<span class="line"><span style="color:#90A4AE;">                    </span><span style="color:#39ADB5;font-style:italic;">break</span><span style="color:#39ADB5;">;</span></span>
<span class="line"><span style="color:#90A4AE;">                </span><span style="color:#39ADB5;">}</span></span>
<span class="line"><span style="color:#90A4AE;">            </span><span style="color:#39ADB5;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#90A4AE;">        </span><span style="color:#39ADB5;">}</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;font-style:italic;">catch</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">(</span><span style="color:#9C3EDA;">IOException</span><span style="color:#90A4AE;"> </span><span style="color:#90A4AE;font-style:italic;">e</span><span style="color:#39ADB5;">)</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">{</span></span>
<span class="line"><span style="color:#90A4AE;">            System</span><span style="color:#39ADB5;">.</span><span style="color:#90A4AE;">out</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">println</span><span style="color:#39ADB5;">(</span><span style="color:#39ADB5;">&quot;</span><span style="color:#91B859;">IOException: </span><span style="color:#39ADB5;">&quot;</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">+</span><span style="color:#90A4AE;"> e</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">getMessage</span><span style="color:#39ADB5;">());</span></span>
<span class="line"><span style="color:#90A4AE;">        </span><span style="color:#39ADB5;">}</span></span>
<span class="line"><span style="color:#90A4AE;">        salida</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">close</span><span style="color:#39ADB5;">();</span></span>
<span class="line"><span style="color:#90A4AE;">        entrada</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">close</span><span style="color:#39ADB5;">();</span></span>
<span class="line"><span style="color:#90A4AE;">        socketCliente</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">close</span><span style="color:#39ADB5;">();</span></span>
<span class="line"><span style="color:#90A4AE;">        socketServidor</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">close</span><span style="color:#39ADB5;">();</span></span>
<span class="line"><span style="color:#90A4AE;">    </span><span style="color:#39ADB5;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#39ADB5;">}</span></span>
<span class="line"></span></code></pre><div class="highlight-lines"><br><br><br><br><br><br><br><br><div class="highlight-line"> </div><br><br><br><br><br><br><br><br><br><br><br><br><br><div class="highlight-line"> </div><br><br><div class="highlight-line"> </div><br><br><div class="highlight-line"> </div><br><br><br><br><br><br><div class="highlight-line"> </div><br><br><br><div class="highlight-line"> </div><br><br><br><br><br><br><br><br><br><div class="highlight-line"> </div><div class="highlight-line"> </div><div class="highlight-line"> </div><div class="highlight-line"> </div><br><br><br></div><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Quedando la secuencia de acciones entre el cliente y el servidor de la siguiente manera</p><p><img src="/psp_pages/assets/monothread_server_sequence-2ef75f85.png" alt="Estados de un servidor monohilo"></p><p>El servidor monohilo se encarga de realizar las operaciones de E/S con el cliente. Hasta que no acaba no puede hacer otro <code>accept</code> y atender a otro cliente.</p><div class="custom-container warning"><p class="custom-container-title">Local Name Resolver (hosts file)</p><p>Deberías saber que DNS traduce nombre de dominio en direcciones IP. Pero, ¿sabes que hay un archivo en tu sistema que puede sobrescribir esas traducciones?</p><p>Es el archivo <code>hosts</code> y nos permite mapear nombre de dominio a direcciones IP. Tu archivo HOSTS sólo afecta al comportamiento de tu equipo, por lo que podemos usarlo para crear direcciones personalizadas para IP de nuestra red, o bien para redireccionar / bloquear el acceso a determinados sitios web.</p><p>Como puedes imaginar, cambiar de forma incorrecta o <strong>maliciosa</strong> el contenido del archivo hOSTS puede romper fácilmente el comportamiento de tu conexión a Internet, Así que la modificación del archivo no es trivial para los usuarios, algo que es de agradecer.</p><ul><li>Windows</li></ul><p>El archivo HOSTS está almacenado como un fichero de texto plano en la carpeta del sistema de Windows.</p><p>Abre el menú inicio y escribe &quot;notepad&quot;.</p><p>Pulsa con el botón derecho y selecciona la opción de &quot;Ejecutar como administrador&quot;</p><p>En Notepad, ve a Archivo &gt; Abrir y pega la siguiente ruta:</p><p>c:\Windows\System32\Drivers\etc\hosts</p><p>Ahora ya puedes editar y guardar los cambios en tu archivo HOSTS.</p><p>Para mapear un dominio, añade una nueva línea siguiendo los ejemplos que hay en el archivo.</p><ul><li>OS X &amp; GNU/Linux</li></ul><p>El archivo está en /etc/hosts y debes editarlo con privilegios de administrador.</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="shiki material-theme-lighter" style="background-color:#FAFAFA;" tabindex="0"><code><span class="line"><span style="color:#90A4AE;font-style:italic;"># Añadimos las siguientes entradas al archivo hosts</span></span>
<span class="line"><span style="color:#90A4AE;font-style:italic;">## En clase </span></span>
<span class="line"><span style="color:#90A4AE;font-style:italic;">##  - como cliente y servidor ponemos la IP de nuestro equipo.</span></span>
<span class="line"><span style="color:#90A4AE;font-style:italic;">##  - como profesor ponemos la IP del ordenador del profesor</span></span>
<span class="line"><span style="color:#90A4AE;font-style:italic;">## En casa (la dirección probablemente tenga el formato 192.168.X.X)</span></span>
<span class="line"><span style="color:#90A4AE;font-style:italic;">##  - como cliente, servidor y profesor ponemos la IP de nuestro equipo.</span></span>
<span class="line"></span>
<span class="line"><span style="color:#90A4AE;font-style:italic;"># En nuestras actividades, para no tener que ir cambiando las direcciones IP, usaremos </span></span>
<span class="line"><span style="color:#90A4AE;font-style:italic;"># siempre estos nombres de dominio, así los programas funcionarán tanto en clase como</span></span>
<span class="line"><span style="color:#90A4AE;font-style:italic;"># en casa.</span></span>
<span class="line"><span style="color:#E2931D;">10.100.XX.1</span><span style="color:#90A4AE;"> </span><span style="color:#91B859;">cliente.psp</span></span>
<span class="line"><span style="color:#E2931D;">10.100.XX.1</span><span style="color:#90A4AE;"> </span><span style="color:#91B859;">servidor.psp</span><span style="color:#90A4AE;"> </span></span>
<span class="line"><span style="color:#E2931D;">10.100.0.1</span><span style="color:#90A4AE;"> </span><span style="color:#91B859;">profesor.psp</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></div><div class="pagebreak"></div><h2 id="_4-2-4-servidor-multihilo" tabindex="-1">4.2.4 Servidor multihilo</h2><p>Si queremos que un servidor pueda atender varias peticiones de forma simultanea, debemos usar hilos para dotarle de esa capacidad.</p><p>El flujo básico ahora cambiaría para adaptarse a este formato</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="shiki material-theme-lighter" style="background-color:#FAFAFA;" tabindex="0"><code><span class="line"><span style="color:#90A4AE;">while (true) {</span></span>
<span class="line"><span style="color:#90A4AE;"></span></span>
<span class="line"><span style="color:#90A4AE;">    Aceptar la conexión obteniendo un objeto de la clase Socket;</span></span>
<span class="line"><span style="color:#90A4AE;"></span></span>
<span class="line"><span style="color:#90A4AE;">    Crear un thread para que se encargue de la comunicación con ese cliente, es decir, </span></span>
<span class="line"><span style="color:#90A4AE;">    para que gestione el socket obtenido en el accept.;</span></span>
<span class="line"><span style="color:#90A4AE;">}</span></span>
<span class="line"><span style="color:#90A4AE;"></span></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="/psp_pages/assets/multithread_server_states-db58ac36.png" alt="Estados de un servidor multihilo"></p><p>El servidor multihilo crea un nuevo hilo que se encarga de las operaciones de E/S con el cliente. Mientras tanto puede esperar la conexión de nuevos clientes con los que volverá a hacer lo mismo.</p><p>El servidor multihilo se ayuda de una clase <code>Worker</code> que hereda de Thread, pudiendo así ejecutarse concurrentemente con el hilo principal.</p><p>Esta clase <code>Worker</code> es la encargada de realizar toda la comunicación con el cliente y el servidor. Para poder hacerlo, en su constructor recibe el Socket que se crea cuando se recibe la conexión de un cliente <code>ServerSocket.accept()</code>.</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="shiki material-theme-lighter" style="background-color:#FAFAFA;" tabindex="0"><code><span class="line"><span style="color:#9C3EDA;">public</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">static</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">final</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">int</span><span style="color:#90A4AE;"> PORT </span><span style="color:#39ADB5;">=</span><span style="color:#90A4AE;"> </span><span style="color:#F76D47;">4444</span><span style="color:#39ADB5;">;</span></span>
<span class="line"><span style="color:#9C3EDA;">public</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">static</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">void</span><span style="color:#90A4AE;"> </span><span style="color:#6182B8;">main</span><span style="color:#39ADB5;">(</span><span style="color:#9C3EDA;">String</span><span style="color:#39ADB5;">[]</span><span style="color:#90A4AE;"> args</span><span style="color:#39ADB5;">)</span><span style="color:#90A4AE;">  </span><span style="color:#39ADB5;">{</span></span>
<span class="line"><span style="color:#39ADB5;">    </span><span style="color:#90A4AE;font-style:italic;">// Establece el puerto en el que escucha peticiones</span></span>
<span class="line"><span style="color:#90A4AE;">    </span><span style="color:#9C3EDA;">ServerSocket</span><span style="color:#90A4AE;"> socketServidor </span><span style="color:#39ADB5;">=</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">null;</span></span>
<span class="line"><span style="color:#90A4AE;">    </span><span style="color:#39ADB5;font-style:italic;">try</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">{</span></span>
<span class="line"><span style="color:#90A4AE;">        socketServidor </span><span style="color:#39ADB5;">=</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;font-style:italic;">new</span><span style="color:#90A4AE;"> </span><span style="color:#6182B8;">ServerSocket</span><span style="color:#39ADB5;">(</span><span style="color:#90A4AE;">PORT</span><span style="color:#39ADB5;">);</span></span>
<span class="line"><span style="color:#90A4AE;">    </span><span style="color:#39ADB5;">}</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;font-style:italic;">catch</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">(</span><span style="color:#9C3EDA;">IOException</span><span style="color:#90A4AE;"> </span><span style="color:#90A4AE;font-style:italic;">e</span><span style="color:#39ADB5;">)</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">{</span></span>
<span class="line"><span style="color:#90A4AE;">        System</span><span style="color:#39ADB5;">.</span><span style="color:#90A4AE;">out</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">println</span><span style="color:#39ADB5;">(</span><span style="color:#39ADB5;">&quot;</span><span style="color:#91B859;">No puede escuchar en el puerto: </span><span style="color:#39ADB5;">&quot;</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">+</span><span style="color:#90A4AE;"> PORT</span><span style="color:#39ADB5;">);</span></span>
<span class="line"><span style="color:#90A4AE;">        System</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">exit</span><span style="color:#39ADB5;">(-</span><span style="color:#F76D47;">1</span><span style="color:#39ADB5;">);</span></span>
<span class="line"><span style="color:#90A4AE;">    </span><span style="color:#39ADB5;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#90A4AE;">    </span><span style="color:#9C3EDA;">Socket</span><span style="color:#90A4AE;"> socketCliente </span><span style="color:#39ADB5;">=</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">null;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#90A4AE;">    System</span><span style="color:#39ADB5;">.</span><span style="color:#90A4AE;">out</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">println</span><span style="color:#39ADB5;">(</span><span style="color:#39ADB5;">&quot;</span><span style="color:#91B859;">Escuchando: </span><span style="color:#39ADB5;">&quot;</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">+</span><span style="color:#90A4AE;"> socketServidor</span><span style="color:#39ADB5;">);</span></span>
<span class="line"><span style="color:#90A4AE;">    </span><span style="color:#39ADB5;font-style:italic;">try</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">{</span></span>
<span class="line"><span style="color:#90A4AE;">        </span></span>
<span class="line"><span style="color:#90A4AE;">        </span><span style="color:#39ADB5;font-style:italic;">while</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">(true)</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">{</span></span>
<span class="line"><span style="color:#39ADB5;">            </span><span style="color:#90A4AE;font-style:italic;">// Se bloquea hasta que recibe alguna petición de un cliente</span></span>
<span class="line"><span style="color:#39ADB5;">            </span><span style="color:#90A4AE;font-style:italic;">// abriendo un socket para el cliente</span></span>
<span class="line"><span style="color:#90A4AE;">            socketCliente </span><span style="color:#39ADB5;">=</span><span style="color:#90A4AE;"> socketServidor</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">accept</span><span style="color:#39ADB5;">();</span></span>
<span class="line"><span style="color:#90A4AE;">            System</span><span style="color:#39ADB5;">.</span><span style="color:#90A4AE;">out</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">println</span><span style="color:#39ADB5;">(</span><span style="color:#39ADB5;">&quot;</span><span style="color:#91B859;">Conexión aceptada: </span><span style="color:#39ADB5;">&quot;</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">+</span><span style="color:#90A4AE;"> socketCliente</span><span style="color:#39ADB5;">);</span></span>
<span class="line"><span style="color:#39ADB5;">            </span><span style="color:#90A4AE;font-style:italic;">// Para seguir aceptando peticiones de otros clientes</span></span>
<span class="line"><span style="color:#39ADB5;">            </span><span style="color:#90A4AE;font-style:italic;">// se crea un nuevo hilo que se encargará de la comunicación con el cliente</span></span>
<span class="line"><span style="color:#90A4AE;">            </span><span style="color:#39ADB5;font-style:italic;">new</span><span style="color:#90A4AE;"> </span><span style="color:#6182B8;">Worker</span><span style="color:#39ADB5;">(</span><span style="color:#90A4AE;">socketCliente</span><span style="color:#39ADB5;">).</span><span style="color:#6182B8;">start</span><span style="color:#39ADB5;">();</span></span>
<span class="line"><span style="color:#90A4AE;">        </span><span style="color:#39ADB5;">}</span></span>
<span class="line"><span style="color:#90A4AE;">                        </span></span>
<span class="line"><span style="color:#90A4AE;">    </span><span style="color:#39ADB5;">...</span></span>
<span class="line"><span style="color:#39ADB5;">}</span><span style="color:#90A4AE;">    </span></span>
<span class="line"></span></code></pre><div class="highlight-lines"><br><br><br><br><br><div class="highlight-line"> </div><br><br><br><br><br><br><br><br><br><br><br><br><br><div class="highlight-line"> </div><br><br><br><div class="highlight-line"> </div><br><br><br><br></div><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Y esta sería una implementación estándar de un worker</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="shiki material-theme-lighter" style="background-color:#FAFAFA;" tabindex="0"><code><span class="line"><span style="color:#9C3EDA;">public</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">class</span><span style="color:#90A4AE;"> </span><span style="color:#E2931D;">Worker</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">extends</span><span style="color:#90A4AE;"> </span><span style="color:#E2931D;">Thread</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">{</span></span>
<span class="line"></span>
<span class="line"><span style="color:#90A4AE;">    </span><span style="color:#9C3EDA;">private</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">Socket</span><span style="color:#90A4AE;"> socketCliente</span><span style="color:#39ADB5;">;</span></span>
<span class="line"><span style="color:#90A4AE;">    </span><span style="color:#9C3EDA;">private</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">BufferedReader</span><span style="color:#90A4AE;"> entrada </span><span style="color:#39ADB5;">=</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">null;</span></span>
<span class="line"><span style="color:#90A4AE;">    </span><span style="color:#9C3EDA;">private</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">PrintWriter</span><span style="color:#90A4AE;"> salida </span><span style="color:#39ADB5;">=</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">null;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#90A4AE;">    </span><span style="color:#39ADB5;">....</span></span>
<span class="line"></span>
<span class="line"><span style="color:#90A4AE;">    </span><span style="color:#39ADB5;">@</span><span style="color:#9C3EDA;">Override</span></span>
<span class="line"><span style="color:#90A4AE;">    </span><span style="color:#9C3EDA;">public</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">void</span><span style="color:#90A4AE;"> </span><span style="color:#6182B8;">run</span><span style="color:#39ADB5;">()</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">{</span></span>
<span class="line"><span style="color:#90A4AE;">        </span><span style="color:#39ADB5;font-style:italic;">try</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">{</span></span>
<span class="line"><span style="color:#39ADB5;">            </span><span style="color:#90A4AE;font-style:italic;">// Establece canal de entrada</span></span>
<span class="line"><span style="color:#90A4AE;">            entrada </span><span style="color:#39ADB5;">=</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;font-style:italic;">new</span><span style="color:#90A4AE;"> </span><span style="color:#6182B8;">BufferedReader</span><span style="color:#39ADB5;">(</span><span style="color:#39ADB5;font-style:italic;">new</span><span style="color:#90A4AE;"> </span><span style="color:#6182B8;">InputStreamReader</span><span style="color:#39ADB5;">(</span><span style="color:#90A4AE;">socketCliente</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">getInputStream</span><span style="color:#39ADB5;">()));</span></span>
<span class="line"><span style="color:#39ADB5;">            </span><span style="color:#90A4AE;font-style:italic;">// Establece canal de salida</span></span>
<span class="line"><span style="color:#90A4AE;">            salida </span><span style="color:#39ADB5;">=</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;font-style:italic;">new</span><span style="color:#90A4AE;"> </span><span style="color:#6182B8;">PrintWriter</span><span style="color:#39ADB5;">(</span><span style="color:#39ADB5;font-style:italic;">new</span><span style="color:#90A4AE;"> </span><span style="color:#6182B8;">BufferedWriter</span><span style="color:#39ADB5;">(</span><span style="color:#39ADB5;font-style:italic;">new</span><span style="color:#90A4AE;"> </span><span style="color:#6182B8;">OutputStreamWriter</span><span style="color:#39ADB5;">(</span><span style="color:#90A4AE;">socketCliente</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">getOutputStream</span><span style="color:#39ADB5;">())),</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">true);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#39ADB5;">            </span><span style="color:#90A4AE;font-style:italic;">// Realizamos la comunicación entre servidor y cliente</span></span>
<span class="line"><span style="color:#39ADB5;">            </span><span style="color:#90A4AE;font-style:italic;">// **** ES LO QUE CAMBIA EN CADA EJERCICIO ****</span></span>
<span class="line"></span>
<span class="line"><span style="color:#39ADB5;">            </span><span style="color:#90A4AE;font-style:italic;">// Hacemos una recepción de información desde el cliente</span></span>
<span class="line"><span style="color:#90A4AE;">            </span><span style="color:#9C3EDA;">String</span><span style="color:#90A4AE;"> mensajeRecibido </span><span style="color:#39ADB5;">=</span><span style="color:#90A4AE;"> entrada</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">readLine</span><span style="color:#39ADB5;">();</span></span>
<span class="line"><span style="color:#90A4AE;">            System</span><span style="color:#39ADB5;">.</span><span style="color:#90A4AE;">out</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">println</span><span style="color:#39ADB5;">(</span><span style="color:#39ADB5;">&quot;</span><span style="color:#91B859;">&lt;-- Cliente: </span><span style="color:#39ADB5;">&quot;</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">+</span><span style="color:#90A4AE;"> mensajeRecibido</span><span style="color:#39ADB5;">);</span></span>
<span class="line"><span style="color:#90A4AE;">            </span></span>
<span class="line"><span style="color:#39ADB5;">            </span><span style="color:#90A4AE;font-style:italic;">// Hacemos un envío al cliente</span></span>
<span class="line"><span style="color:#90A4AE;">            </span><span style="color:#9C3EDA;">String</span><span style="color:#90A4AE;"> mensajeEnviado </span><span style="color:#39ADB5;">=</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">&quot;</span><span style="color:#91B859;">Mensaje enviado desde el servidor al cliente</span><span style="color:#39ADB5;">&quot;</span><span style="color:#39ADB5;">;</span></span>
<span class="line"><span style="color:#90A4AE;">            salida</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">println</span><span style="color:#39ADB5;">(</span><span style="color:#90A4AE;">mensajeEnviado</span><span style="color:#39ADB5;">);</span></span>
<span class="line"><span style="color:#90A4AE;">            System</span><span style="color:#39ADB5;">.</span><span style="color:#90A4AE;">out</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">println</span><span style="color:#39ADB5;">(</span><span style="color:#39ADB5;">&quot;</span><span style="color:#91B859;">--&gt; Cliente: </span><span style="color:#39ADB5;">&quot;</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">+</span><span style="color:#90A4AE;"> mensajeEnviado</span><span style="color:#39ADB5;">);</span></span>
<span class="line"><span style="color:#90A4AE;">        </span><span style="color:#39ADB5;">}</span></span>
<span class="line"><span style="color:#90A4AE;">        </span><span style="color:#39ADB5;">....</span></span>
<span class="line"><span style="color:#39ADB5;">}</span><span style="color:#90A4AE;">        </span></span>
<span class="line"></span></code></pre><div class="highlight-lines"><br><br><br><br><br><br><br><br><br><br><br><br><div class="highlight-line"> </div><br><div class="highlight-line"> </div><br><br><br><br><br><br><div class="highlight-line"> </div><br><br><br><div class="highlight-line"> </div><br><br><br><br></div><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Quedando ahora la secuencia de acciones entre el cliente y el servidor de la siguiente manera</p><p><img src="/psp_pages/assets/multithread_server_sequence-6164131b.png" alt="Estados de un servidor monohilo"></p><div class="pagebreak"></div><div class="custom-container info"><p class="custom-container-title">Ejecución de múltiples clientes desde línea de comandos</p><p>Para poder lanzar varias aplicaciones java a la vez, la forma más correcta de hacerlo es desde una terminal de comandos. Esto nos permite poder pasarle argumentos a todas las clases, no sólo a la que está marcada como <em>principal</em> en el proyecto.</p><p>Aquí tenemos dos posibilidades, <strong>ejecutar las clases individualmente</strong>, tal y como hacemos desde el IDE o bien <strong>lanzar las clases desde un archivo JAR</strong>.</p><p>En ambos casos, necesitamos haber compilado y construido el proyecto (<em>F11 ó Shift+F11 en Netbeans</em>).</p><p>Ejecución de clases individuales</p><ul><li><p>Lo primero, tal y como se ha indicado anteriormente, debemos tener las clases compiladas.</p></li><li><p>A continuación, al igual que hacíamos con los procesos, debemos ubicarnos en la carpeta <code>build/classes</code> del proyecto.</p></li><li><p>Desde ahí, ejecutaremos</p><blockquote><p>build/classes$ java psp.actividades.U4AX_ClaseServidor 5566</p></blockquote><p>los valores que ponemos a continuación del nombre de la clase son los parámetros que la clase recibirá en el args[] de su método main.</p><p>y para la clase o clases que no sean las principales</p><blockquote><p>build/classes$ java psp.actividades.U4AX_ClaseSCliente localhost 5566</p></blockquote><p>Si queremos lanzar más de un cliente, repetiremos el comando desde otra ventana de comandos.</p></li></ul><p>Lanzar las clases desde un archivo JAR</p><ul><li><p>Lo primero, tal y como se ha indicado anteriormente, debemos tener el proyecto construido</p></li><li><p>A continuación, y a diferencia del caso anterior, debemos ubicarnos en el directorio donde esté el archivo JAR. Si no lo hemos movido, estará en la carpeta <code>dist</code> del proyecto.</p></li><li><p>Desde ahí, ejecutaremos, <strong>para la clase principal del proyecto</strong></p><blockquote><p>dist$ java -jar U4AX_ProyectoClienteServidor.jar 5566</p></blockquote><blockquote><p>dist$ java -cp U4AX_ProyectoClienteServidor.jar psp.actividades.U4AX_ClaseServidor 5566</p></blockquote><p>los valores que ponemos a continuación del nombre de la clase son los parámetros que la clase recibirá en el args[] de su método main.</p><p>y para la clase o clases que no sean las principales</p><blockquote><p>dist$ java -cp U4AX_ProyectoClienteServidor.jar psp.actividades.U4AX_ClaseCliente localhost 5566</p></blockquote><p>Si queremos lanzar más de un cliente, repetiremos el comando desde otra ventana de comandos.</p></li></ul></div></div><!--[--><!--]--></div><footer class="page-meta"><!----><div class="meta-item last-updated"><span class="meta-item-label">Última actualización: </span><!----></div><div class="meta-item contributors"><span class="meta-item-label">Editores: </span><span class="meta-item-info"><!--[--><!--[--><span class="contributor" title="email: vicente@iesdoctorbalmis.com">Vicente Martínez</span><!----><!--]--><!--]--></span></div></footer><nav class="page-nav"><p class="inner"><span class="prev"><a href="/psp_pages/es/unit4/tcp-ip.html" class="" aria-label="4.1 Pila de protocolos TCP IP"><!--[--><!--]--> 4.1 Pila de protocolos TCP IP <!--[--><!--]--></a></span><span class="next"><a href="/psp_pages/es/unit4/sockets-udp.html" class="" aria-label="4.3 Sockets UDP"><!--[--><!--]--> 4.3 Sockets UDP <!--[--><!--]--></a></span></p></nav><!--[--><!--]--></main><!--]--></div><!----><!--]--></div>
    <script type="module" src="/psp_pages/assets/app-f513d7ce.js" defer></script>
  </body>
</html>
